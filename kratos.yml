version: v0.8.2-alpha.1

dsn: sqlite:///var/lib/sqlite/db.sqlite?_fk=true

serve:
  public:
    base_url: https://<API_URL>/kratos/public # TODO
    cors:
      enabled: true
      allowed_origins:
        - https://<FRONTEND_URL> # TODO
      allowed_methods:
        - POST
        - GET
        - PUT
        - PATCH
        - DELETE
      allowed_headers:
        - Content-Type
        - Authorization
        - Cookie
      exposed_headers:
        - Content-Type
        - Set-Cookie
      debug: false

selfservice:

  default_browser_return_url: https://<FRONTEND_URL>/u/signin # TODO
  whitelisted_return_urls:
    - https://<FRONTEND_URL> # TODO

  methods:
    password:
      enabled: false
    profile:
      enabled: true
    oidc:
      enabled: true
      config:
        providers:
          - id: gitlab # this is `<provider-id>` in the Authorization callback URL. DO NOT CHANGE IT ONCE SET!
            provider: gitlab
            # TODO : Paste your Application ID and Application secret here :
            client_id: # Application ID
            client_secret: # Secret
            mapper_url: file:///etc/config/kratos/oidc.gitlab.jsonnet
            scope:
              - openid
              - email

  flows:
    registration:
      after:
        oidc:
          hooks:
            - hook: session
    login:
      ui_url: https://<FRONTEND_URL>/u/signin # TODO
    error:
      ui_url: https://<FRONTEND_URL> # TODO
    logout:
      after:
        default_browser_return_url: https://<FRONTEND_URL> # TODO
    settings:
      ui_url: https://<FRONTEND_URL>/u/dashboard/profile # TODO

cookies:
  domain: <DOMAIN_NAME> # TODO

log:
  level: debug
  format: text
  leak_sensitive_values: false

identity:
  default_schema_url: file:///etc/config/kratos/identity.schema.json

courier:
  smtp:
    connection_uri: smtp://mailhog:1025
